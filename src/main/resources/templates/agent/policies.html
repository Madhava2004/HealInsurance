<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Policy Catalog – HIMS Agent</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/assets/logo.jpeg" type="image/svg+xml">
 
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
 
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            sidebar: "#ffffff",
            bg: "#f8fafc",
            card: "#ffffff",
            border: "#e5e7eb",
            muted: "#64748b",
            primary: "#10b981",
            primaryHover: "#059669",
            success: "#10b981"
          }
        }
      }
    }
  </script>
 
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1e293b; }
 
    .gradient-primary { background: linear-gradient(135deg, #10b981, #059669); }
    
    /* NAV BUTTON STYLES FROM PROFILE */
    .nav-btn {
        width: 100%;
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        border-radius: 12px;
        transition: all 0.15s ease;
        color: #64748b; /* Slate 500 */
        font-weight: 500;
    }
    
    .nav-btn:hover {
        background: #f1f5f9; /* Slate 100 */
        color: #0f172a; /* Slate 900 */
    }
    
    .nav-btn.active {
        background: #ecfdf5; /* Emerald 50 */
        color: #059669; /* Emerald 600 */
        font-weight: 600;
    }
 
    /* KPI Card Hover Effect (From Policies) */
    .kpi-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 2px solid transparent;
        background: white;
        border-radius: 2rem; /* Matching Profile card radius */
        border: 1px solid #f1f5f9;
    }
    .kpi-card:hover {
        transform: translateY(-5px);
        border-color: #10b981;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }
 
    .hidden-modal { display: none !important; }
  </style>
</head>
 
<body class="bg-bg text-slate-900 flex min-h-screen">
 
<aside class="fixed inset-y-0 left-0 w-64 bg-sidebar border-r border-slate-200 flex flex-col z-40">
  <div class="p-6 flex items-center gap-3">
    <div class="w-10 h-10 gradient-primary rounded-xl flex items-center justify-center">
      <i data-lucide="shield" class="text-white"></i>
    </div>
    <div>
      <h1 class="font-bold leading-tight text-slate-900">GENC HIMS</h1>
      <p class="text-xs text-slate-500">Agent Portal</p>
    </div>
  </div>
 
  <nav class="px-4 space-y-1 flex-1">
    <a th:href="@{/agent/dashboard}" class="nav-btn"><i data-lucide="layout-dashboard"></i> Dashboard</a>
    
    <a th:href="@{/agent/policies}" class="nav-btn active">
        <i data-lucide="file-text"></i> Policies
    </a>
    
    <a th:href="@{/agent/claims}" class="nav-btn"><i data-lucide="clipboard-list"></i> Claims</a>
    <a th:href="@{/agent/customers}" class="nav-btn"><i data-lucide="users"></i> Customers</a>
    <a th:href="@{/agent/support}" class="nav-btn"><i data-lucide="headphones"></i> Support</a>
    <a th:href="@{/agent/profile}" class="nav-btn"><i data-lucide="user"></i> Profile</a>
  </nav>
 
  <div class="p-4 border-t border-slate-100">
    <button onclick="logout()" class="w-full flex items-center gap-3 p-3 rounded-xl text-red-600 hover:bg-red-50 font-semibold transition-colors">
      <i data-lucide="log-out"></i>Logout
    </button>
  </div>
</aside>
 
<main class="ml-64 flex-1 p-8">
  <div class="max-w-[1600px] mx-auto"> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8">
        <div>
            <h1 class="text-3xl font-bold text-slate-900 mb-2">Policy Catalog</h1>
            <p class="text-slate-500 font-medium">View details of available insurance plans</p>
        </div>
        
        <a th:href="@{/agent/policies(sortField='premiumAmount', sortDir=${reverseSortDir})}"
           class="flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 rounded-xl text-xs font-bold text-slate-500 hover:border-emerald-500 hover:text-emerald-600 transition-all shadow-sm">
            Sort by Price <i data-lucide="arrow-up-down" class="w-3 h-3 text-emerald-500"></i>
        </a>
    </div>
 
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        
        <div th:each="plan : ${policies}" class="kpi-card overflow-hidden flex flex-col">
            
            <div class="bg-gradient-to-r from-emerald-500 to-teal-600 p-8 text-white relative">
                <div class="flex items-center justify-between mb-6">
                    <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm">
                        <i data-lucide="shield" class="w-6 h-6 text-white"></i>
                    </div>
                    <span class="px-3 py-1 rounded-full bg-white/20 text-[10px] font-bold uppercase tracking-widest backdrop-blur-md">Active Plan</span>
                </div>
                <h3 class="text-xl font-bold leading-tight mb-1" th:text="${plan.coverageType}">Plan Name</h3>
                <p class="text-emerald-50 text-xs font-medium">Marketplace Template</p>
            </div>
 
            <div class="p-8 space-y-6 flex-1 flex flex-col">
                <div class="flex justify-between items-center">
                    <span class="flex items-center gap-2 text-sm text-slate-400 font-medium">
                        <i data-lucide="indian-rupee" class="w-4 h-4"></i> Coverage
                    </span>
                    <span class="font-bold text-slate-900 text-lg"
                          th:text="${'₹' + #numbers.formatDecimal(plan.coverageAmount, 0, 'COMMA', 0, 'POINT')}">₹0</span>
                </div>
 
                <div class="flex justify-between items-center pb-6 border-b border-slate-50">
                    <span class="flex items-center gap-2 text-sm text-slate-400 font-medium">
                        <i data-lucide="credit-card" class="w-4 h-4"></i> Premium
                    </span>
                    <span class="font-bold text-slate-900"
                          th:text="${'₹' + plan.premiumAmount + '/y'}">₹0</span>
                </div>
 
                <div class="mt-auto">
                    <button
                        th:data-name="${plan.coverageType}"
                        th:data-cov="${plan.coverageAmount}"
                        th:data-prem="${plan.premiumAmount}"
                        th:data-id="${plan.policyNumber}"
                        onclick="openPlanModal(this)"
                        class="w-full flex items-center justify-center py-4 rounded-2xl border border-slate-200 font-bold text-slate-500 hover:border-emerald-500 hover:text-emerald-600 hover:bg-emerald-50 transition-all text-sm group">
                        View Plan Details <i data-lucide="arrow-right" class="w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"></i>
                    </button>
                </div>
            </div>
        </div>
 
        <div th:if="${policies == null or policies.isEmpty()}" class="col-span-full py-20 text-center bg-white rounded-[32px] border border-slate-100 border-dashed">
            <div class="w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="file-x" class="w-8 h-8 text-slate-300"></i>
            </div>
            <p class="text-slate-500 font-medium">No marketplace plans available.</p>
        </div>
 
    </div>
 
    <div th:if="${totalPages > 0}" class="mt-8 flex items-center justify-between bg-white p-6 rounded-[24px] border border-slate-100 shadow-sm">
        <span class="text-sm text-slate-500">Page [[${currentPage + 1}]] of [[${totalPages}]]</span>
        
        <div class="flex gap-2">
            <a th:if="${currentPage > 0}"
               th:href="@{/agent/policies(page=${currentPage - 1}, sortField=${sortField}, sortDir=${sortDir})}"
               class="p-2 bg-slate-50 rounded-lg hover:bg-emerald-50 text-slate-600">
               <i data-lucide="chevron-left" class="w-4 h-4"></i>
            </a>
 
            <div class="flex gap-1" th:if="${totalPages > 0}">
                <a th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                   th:href="@{/agent/policies(page=${i}, sortField=${sortField}, sortDir=${sortDir})}"
                   th:text="${i + 1}"
                   th:classappend="${currentPage == i} ? 'bg-emerald-500 text-white' : 'bg-slate-50 text-slate-600'"
                   class="w-10 h-10 flex items-center justify-center rounded-lg font-bold text-xs">
                </a>
            </div>
 
            <a th:if="${currentPage < totalPages - 1}"
               th:href="@{/agent/policies(page=${currentPage + 1}, sortField=${sortField}, sortDir=${sortDir})}"
               class="p-2 bg-slate-50 rounded-lg hover:bg-emerald-50 text-slate-600">
               <i data-lucide="chevron-right" class="w-4 h-4"></i>
            </a>
        </div>
    </div>
 
  </div>
</main>
 
<div id="planModal" class="hidden-modal fixed inset-0 z-[100] bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4">
    <div class="bg-white w-full max-w-lg rounded-[32px] shadow-2xl relative overflow-hidden transform transition-all scale-100">
        <button onclick="closePlanModal()" class="absolute top-6 right-6 text-slate-300 hover:text-slate-600 transition-colors z-20">
            <i data-lucide="x" class="w-6 h-6"></i>
        </button>
 
        <div class="bg-gradient-to-r from-emerald-500 to-teal-600 p-8 text-white">
             <span class="inline-block px-3 py-1 rounded-full bg-white/20 text-[10px] font-bold uppercase tracking-widest mb-3">Plan Details</span>
             <h3 id="m-plan-name" class="text-2xl font-bold">Plan Name</h3>
             <p id="m-plan-id" class="text-emerald-100 text-sm font-mono mt-1">POL-ID</p>
        </div>
 
        <div class="p-8">
            <div class="grid grid-cols-2 gap-4 mb-8">
                <div class="p-4 bg-slate-50 rounded-2xl border border-slate-100">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1">Coverage Limit</p>
                    <p id="m-plan-cov" class="text-lg font-bold text-slate-900">₹0</p>
                </div>
                <div class="p-4 bg-slate-50 rounded-2xl border border-slate-100">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1">Yearly Premium</p>
                    <p id="m-plan-prem" class="text-lg font-bold text-slate-900">₹0</p>
                </div>
            </div>
 
            <div class="mb-8">
                <h4 class="font-bold text-slate-900 mb-4 flex items-center gap-2">
                    <i data-lucide="star" class="w-4 h-4 text-amber-500 fill-amber-500"></i> Included Benefits
                </h4>
                <div class="space-y-3">
                    <div class="flex items-center gap-3 text-sm text-slate-600">
                        <i data-lucide="check-circle-2" class="w-4 h-4 text-emerald-500"></i> Hospital Room & Board
                    </div>
                    <div class="flex items-center gap-3 text-sm text-slate-600">
                        <i data-lucide="check-circle-2" class="w-4 h-4 text-emerald-500"></i> Surgical Procedures
                    </div>
                    <div class="flex items-center gap-3 text-sm text-slate-600">
                        <i data-lucide="check-circle-2" class="w-4 h-4 text-emerald-500"></i> Prescription Drugs
                    </div>
                    <div class="flex items-center gap-3 text-sm text-slate-600">
                        <i data-lucide="check-circle-2" class="w-4 h-4 text-emerald-500"></i> Preventive Care
                    </div>
                </div>
            </div>
 
            <button onclick="closePlanModal()" class="w-full bg-slate-100 text-slate-700 font-bold py-4 rounded-2xl hover:bg-slate-200 transition-colors">
                Close Details
            </button>
        </div>
    </div>
</div>
 
<script>
    lucide.createIcons();
 
    function logout(){ location.href='/logout' }
 
    // Modal Logic
    function openPlanModal(btn) {
        const name = btn.getAttribute('data-name');
        const cov = btn.getAttribute('data-cov');
        const prem = btn.getAttribute('data-prem');
        const id = btn.getAttribute('data-id');
 
        document.getElementById('m-plan-name').innerText = name;
        document.getElementById('m-plan-id').innerText = id;
        document.getElementById('m-plan-cov').innerText = '₹' + Number(cov).toLocaleString();
        document.getElementById('m-plan-prem').innerText = '₹' + Number(prem).toLocaleString();
 
        document.getElementById('planModal').classList.remove('hidden-modal');
        document.body.style.overflow = 'hidden';
    }
 
    function closePlanModal() {
        document.getElementById('planModal').classList.add('hidden-modal');
        document.body.style.overflow = 'auto';
    }
 
    // Close on backdrop click
    document.getElementById('planModal').addEventListener('click', function(e) {
        if (e.target === this) closePlanModal();
    });
</script>
 
</body>
</html>